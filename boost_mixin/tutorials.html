<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Tutorials</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;Boost.Mixin 0.1">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;Boost.Mixin 0.1">
<link rel="prev" href="glossary.html" title="Glossary">
<link rel="next" href="examples.html" title="Examples">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="glossary.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="examples.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="boost_mixin.tutorials"></a><a class="link" href="tutorials.html" title="Tutorials">Tutorials</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="tutorials.html#boost_mixin.tutorials.messages">Messages</a></span></dt>
<dt><span class="section"><a href="tutorials.html#boost_mixin.tutorials.combinators">Multicast combinators</a></span></dt>
<dt><span class="section"><a href="tutorials.html#boost_mixin.tutorials.mutation">Object mutation</a></span></dt>
<dt><span class="section"><a href="tutorials.html#boost_mixin.tutorials.tips_tricks">Tips and tricks</a></span></dt>
<dt><span class="section"><a href="tutorials.html#boost_mixin.tutorials.common_problems">Common problems
      and solutions</a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_mixin.tutorials.messages"></a><a class="link" href="tutorials.html#boost_mixin.tutorials.messages" title="Messages">Messages</a>
</h3></div></div></div>
<p>
        <a class="indexterm" name="idp35017488"></a>
      </p>
<p>
        (For the complete, working source of this example see <a href="https://github.com/iboB/boost.mixin/blob/master/libs/mixin/tutorial/messages.cpp" target="_top">messages.cpp</a>)
      </p>
<p>
        For this tutorial will look a simplified piece of code from an imaginary
        game. First let's define the mixin classes that we're going to use.
      </p>
<p>
        There's a mixin that's a part from evey object of our game. The one that
        gives them a unique id. We'll also define a method, called <code class="computeroutput"><span class="identifier">trace</span></code> that will display information about
        the mixin in a stream.
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">has_id</span>
<span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">void</span> <span class="identifier">set_id</span><span class="special">(</span><span class="keyword">int</span> <span class="identifier">id</span><span class="special">)</span> <span class="special">{</span> <span class="identifier">_id</span> <span class="special">=</span> <span class="identifier">id</span><span class="special">;</span> <span class="special">}</span>
    <span class="keyword">int</span> <span class="identifier">id</span><span class="special">()</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">_id</span><span class="special">;</span> <span class="special">}</span>

    <span class="keyword">void</span> <span class="identifier">trace</span><span class="special">(</span><span class="identifier">ostream</span><span class="special">&amp;</span> <span class="identifier">out</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>

<span class="keyword">private</span><span class="special">:</span>
    <span class="keyword">int</span> <span class="identifier">_id</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<p>
        Next we'll define a class for an animated model. We could have other types
        of models in the game, but for this tutorial there's no need to define anything
        more.
      </p>
<p>
        The mixin offers us a way to set a mesh and two ways to set an animation.
        It has a render method and, again the trace method, to display info about
        this mixin.
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">animated_model</span>
<span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">void</span> <span class="identifier">set_mesh</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">string</span><span class="special">&amp;</span> <span class="identifier">mesh</span><span class="special">);</span>

    <span class="keyword">void</span> <span class="identifier">set_animation</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">string</span><span class="special">&amp;</span> <span class="identifier">animation</span><span class="special">);</span>
    <span class="keyword">void</span> <span class="identifier">set_animation</span><span class="special">(</span><span class="keyword">int</span> <span class="identifier">anim_id</span><span class="special">);</span>

    <span class="keyword">void</span> <span class="identifier">render</span><span class="special">()</span> <span class="keyword">const</span><span class="special">;</span>

    <span class="keyword">void</span> <span class="identifier">trace</span><span class="special">(</span><span class="identifier">ostream</span><span class="special">&amp;</span> <span class="identifier">out</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>

<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">string</span> <span class="identifier">_mesh</span><span class="special">;</span>
    <span class="identifier">string</span> <span class="identifier">_animation</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<p>
        Now we'll define three types of mixins that will give us artificial intelligence
        logic for different occasions. They all share a method called <code class="computeroutput"><span class="identifier">think</span></code> for the AI, and the familiar trace
        method.
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">enemy_ai</span>
<span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">void</span> <span class="identifier">think</span><span class="special">();</span>

    <span class="keyword">void</span> <span class="identifier">trace</span><span class="special">(</span><span class="identifier">ostream</span><span class="special">&amp;</span> <span class="identifier">out</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>
<span class="special">};</span>

<span class="keyword">class</span> <span class="identifier">ally_ai</span>
<span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">void</span> <span class="identifier">think</span><span class="special">();</span>

    <span class="keyword">void</span> <span class="identifier">trace</span><span class="special">(</span><span class="identifier">ostream</span><span class="special">&amp;</span> <span class="identifier">out</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>
<span class="special">};</span>

<span class="keyword">class</span> <span class="identifier">stunned_ai</span>
<span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">void</span> <span class="identifier">think</span><span class="special">();</span>

    <span class="keyword">void</span> <span class="identifier">trace</span><span class="special">(</span><span class="identifier">ostream</span><span class="special">&amp;</span> <span class="identifier">out</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<p>
        Now it's time to declare the messages our mixins will use. We have some methods
        in our classes for which there won't be any messages, since those methods
        aren't polymoriphic. They're unique for their specific classes so it's absolutely
        adequate to call them by <code class="computeroutput"><span class="identifier">object</span><span class="special">.</span><span class="identifier">get</span><span class="special">&lt;</span><span class="identifier">mixin</span><span class="special">&gt;()-&gt;</span><span class="identifier">method</span><span class="special">(...)</span></code>.
      </p>
<p>
        So, let's start with the simplest case. The one we alreay used in the <a class="link" href="basic.html" title="Basic usage">basic usage example</a>.
      </p>
<p>
        The declaration syntax is the familiar macro <code class="computeroutput"><span class="identifier">BOOST_MIXIN_MESSAGE_</span><span class="special">|</span><span class="identifier">N</span><span class="special">|</span></code>,
        where <code class="computeroutput"><span class="special">|</span><span class="identifier">N</span><span class="special">|</span></code> stands for the number of arguments the message
        has. The macro's aruments are coma separated: return value, message/method
        name, argument 1 type, argument 1 name, argument 2 type, argument 2 name,
        etc etc.
      </p>
<p>
        This simple case is covered by the messages <code class="computeroutput"><span class="identifier">think</span></code>
        and <code class="computeroutput"><span class="identifier">set_mesh</span></code> <sup>[<a name="boost_mixin.tutorials.messages.f0" href="#ftn.boost_mixin.tutorials.messages.f0" class="footnote">1</a>]</sup>
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_MIXIN_MESSAGE_0</span><span class="special">(</span><span class="keyword">void</span><span class="special">,</span> <span class="identifier">think</span><span class="special">);</span>
<span class="identifier">BOOST_MIXIN_MESSAGE_1</span><span class="special">(</span><span class="keyword">void</span><span class="special">,</span> <span class="identifier">set_mesh</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">string</span><span class="special">&amp;,</span> <span class="identifier">mesh</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        Now it may seem that <code class="computeroutput"><span class="identifier">render</span></code>
        is also a pretty simple example of a message, but there's a small difference.
        It's supposed to be handled by const methods. This makes it a const message
        and as such it has a different declaration macro &#8211; the same as before
        but with <code class="computeroutput"><span class="identifier">CONST</span></code> added to it:
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_MIXIN_CONST_MESSAGE_0</span><span class="special">(</span><span class="keyword">void</span><span class="special">,</span> <span class="identifier">render</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        Lets see the <code class="computeroutput"><span class="identifier">trace</span></code> method,
        that's presen in all of our classes. If we declare a message for it in the
        way we talked above, only of the mixins within an object will be able to
        handle it. But when we <code class="computeroutput"><span class="identifier">trace</span></code>
        an object's info, we obviously would like to have the info for all of its
        mixins. For cases like this: where more than one of the mixins in an object
        is supposed to handle a message, Boost.Mixin introduces <span class="emphasis"><em>multicast</em></span>
        messages. You declare those by adding <code class="computeroutput"><span class="identifier">MULTICAST</span></code>
        to the macro (before <code class="computeroutput"><span class="identifier">MESSAGE</span></code>
        but after <code class="computeroutput"><span class="identifier">CONST</span></code> if it's a
        const one)
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_MIXIN_CONST_MULTICAST_MESSAGE_1</span><span class="special">(</span><span class="keyword">void</span><span class="special">,</span> <span class="identifier">trace</span><span class="special">,</span> <span class="identifier">ostream</span><span class="special">&amp;,</span> <span class="identifier">out</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        The last type of message there is meant for overloaded methods. For these
        we need message overloads.
      </p>
<p>
        A message overload will require you to think of a special name, that's used
        to refer to that message, different from the name of the method. Don't worry
        though the stand-alone function that's generated for the message call itself
        will have the appropriate name (the method's name).
      </p>
<p>
        The macro used for message overloads is the same as before with <code class="computeroutput"><span class="identifier">OVERLOAD</span></code> at the end. The other difference
        is that its first argument should be the custom name for the message (followed
        by the type, method name, and method/message arguments like before).
      </p>
<p>
        In our case <code class="computeroutput"><span class="identifier">set_animation</span></code>
        has two overloads:
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_MIXIN_MESSAGE_1_OVERLOAD</span><span class="special">(</span><span class="identifier">set_anim_by_name</span><span class="special">,</span> <span class="keyword">void</span><span class="special">,</span> <span class="identifier">set_animation</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">string</span><span class="special">&amp;,</span> <span class="identifier">animation</span><span class="special">);</span>
<span class="identifier">BOOST_MIXIN_MESSAGE_1_OVERLOAD</span><span class="special">(</span><span class="identifier">set_anim_by_id</span><span class="special">,</span> <span class="keyword">void</span><span class="special">,</span> <span class="identifier">set_animation</span><span class="special">,</span> <span class="keyword">int</span><span class="special">,</span> <span class="identifier">anim_id</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        As you might have guessed, any message could be defined as a message overload
        and indeed in the case where there are no overloads <code class="computeroutput"><span class="identifier">BOOST_MIXIN_MESSAGE_N</span><span class="special">(</span><span class="identifier">ret</span><span class="special">,</span>
        <span class="identifier">message_name</span><span class="special">,</span>
        <span class="special">...)</span></code> will just expand to <code class="computeroutput"><span class="identifier">BOOST_MIXIN_MESSAGE_N_OVERLOAD</span><span class="special">(</span><span class="identifier">message_name</span><span class="special">,</span>
        <span class="identifier">ret</span><span class="special">,</span>
        <span class="identifier">message_name</span><span class="special">,</span>
        <span class="special">...)</span></code>
      </p>
<p>
        So, now that we've declared all our messages it's time to define them.
      </p>
<p>
        The macro used for defining a message is always the same, regardless of the
        message's constness, mechanism (multicast/unicast), or overload. It has a
        single argument &#8211; the message's name.
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_MIXIN_DEFINE_MESSAGE</span><span class="special">(</span><span class="identifier">think</span><span class="special">);</span>
<span class="identifier">BOOST_MIXIN_DEFINE_MESSAGE</span><span class="special">(</span><span class="identifier">set_mesh</span><span class="special">);</span>
<span class="identifier">BOOST_MIXIN_DEFINE_MESSAGE</span><span class="special">(</span><span class="identifier">render</span><span class="special">);</span>
<span class="identifier">BOOST_MIXIN_DEFINE_MESSAGE</span><span class="special">(</span><span class="identifier">trace</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        For the overloads we should use our custom name:
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_MIXIN_DEFINE_MESSAGE</span><span class="special">(</span><span class="identifier">set_anim_by_name</span><span class="special">);</span>
<span class="identifier">BOOST_MIXIN_DEFINE_MESSAGE</span><span class="special">(</span><span class="identifier">set_anim_by_id</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        Great! Now that we have our messages it's time to define the classes from
        above as mixins. We met the <code class="computeroutput"><span class="identifier">BOOST_DEFINE_MIXIN</span></code>
        macro from the basic example. It has two arguments &#8211; the mixin/class
        name and it's feature list. The feature list is a ampersand separated list
        symbols that represent the mixin's features and can contain many things but
        for now we'll focus on messages &#8211; the ones this mixin is supposed
        to handle.
      </p>
<p>
        The special thing here, is that in order to distinguish the stand-alone function
        that's generated to make message calls from the message, the library defines
        a special symbol for each message. This symbol is used in the mixin feature
        list and when checking whether a mixin implements a message. The symbol is
        the message postfixed with <code class="computeroutput"><span class="identifier">_msg</span></code>.
      </p>
<p>
        Let's define three of our simple mixins along with their feature (message)
        lists:
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_DEFINE_MIXIN</span><span class="special">(</span><span class="identifier">enemy_ai</span><span class="special">,</span> <span class="identifier">think_msg</span> <span class="special">&amp;</span> <span class="identifier">trace_msg</span><span class="special">);</span>
<span class="identifier">BOOST_DEFINE_MIXIN</span><span class="special">(</span><span class="identifier">ally_ai</span><span class="special">,</span> <span class="identifier">think_msg</span> <span class="special">&amp;</span> <span class="identifier">trace_msg</span><span class="special">);</span>
<span class="identifier">BOOST_DEFINE_MIXIN</span><span class="special">(</span><span class="identifier">animated_model</span><span class="special">,</span>
    <span class="identifier">trace_msg</span> <span class="special">&amp;</span> <span class="identifier">set_mesh_msg</span> <span class="special">&amp;</span> <span class="identifier">set_anim_by_id_msg</span> <span class="special">&amp;</span> <span class="identifier">set_anim_by_name_msg</span> <span class="special">&amp;</span> <span class="identifier">render_msg</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        The reason we left out <code class="computeroutput"><span class="identifier">has_id</span></code>
        and <code class="computeroutput"><span class="identifier">stunned_ai</span></code> is because
        we'd like to do something special with their message lists.
      </p>
<p>
        <a class="indexterm" name="idp35231488"></a>
      </p>
<p>
        First, about <code class="computeroutput"><span class="identifier">has_id</span></code>. What
        we'd like to do is display its info first, because the object id is usually
        the first thing you need about an object. So in otder to achieve this the
        notion of message priority is introduced. Each message in a mixin gets a
        priority of 0 by default. For multicast messages like <code class="computeroutput"><span class="identifier">trace</span></code>
        the priority will affect the order in which they're executed. The higher
        priority a multicast message has in a mixin, the earlier it will be executed.
        So if we set the priority of <code class="computeroutput"><span class="identifier">trace</span></code>
        in <code class="computeroutput"><span class="identifier">has_id</span></code> to something greater
        than zero, we'll have a guarantee that when the object info is displayed
        its id will come first.
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_DEFINE_MIXIN</span><span class="special">(</span><span class="identifier">has_id</span><span class="special">,</span> <span class="identifier">priority</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="identifier">trace_msg</span><span class="special">));</span>
</pre>
<p>
      </p>
<p>
        For unicast messages the priority determines which of the potentially many
        mixin candidates will handle the message. Again mixins with higher priority
        for a message are considered better candidates.
      </p>
<p>
        So if we set the priority of <code class="computeroutput"><span class="identifier">think</span></code>
        in <code class="computeroutput"><span class="identifier">stunned_ai</span></code> to something
        greater than zero, then adding this mixin to an object that already has a
        think message (like objects with <code class="computeroutput"><span class="identifier">enemy_ai</span></code>
        or <code class="computeroutput"><span class="identifier">ally_ai</span></code>) will hide it
        previous implementation and override it with the one from <code class="computeroutput"><span class="identifier">stunned_ai</span></code>.
        If we remove the mixin, the previous implementation will be exposed and will
        resume handling the <code class="computeroutput"><span class="identifier">think</span></code>
        calls.
      </p>
<p>
        Also we'll consider <code class="computeroutput"><span class="identifier">stunned_ai</span></code>
        as a relatively uninteresting mixin, and set the priority of <code class="computeroutput"><span class="identifier">trace</span></code> to -1, and make its info be displayed
        last (if at all available)
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">BOOST_DEFINE_MIXIN</span><span class="special">(</span><span class="identifier">stunned_ai</span><span class="special">,</span> <span class="identifier">priority</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="identifier">think_msg</span><span class="special">)</span> <span class="special">&amp;</span> <span class="identifier">priority</span><span class="special">(-</span><span class="number">1</span><span class="special">,</span> <span class="identifier">trace_msg</span><span class="special">));</span>
</pre>
<p>
      </p>
<p>
        We're now ready to start using our mixins and messages in the simplified
        game.
      </p>
<p>
        Let's start by creating two objects - an enemy and an ally to the hypothetical
        main character. We'll give them some irrelevant id-s and meshes.
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">object</span> <span class="identifier">enemy</span><span class="special">;</span> <span class="comment">// just an empty boost::mixin::object</span>

<span class="identifier">mutate</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">)</span>
    <span class="special">.</span><span class="identifier">add</span><span class="special">&lt;</span><span class="identifier">has_id</span><span class="special">&gt;()</span>
    <span class="special">.</span><span class="identifier">add</span><span class="special">&lt;</span><span class="identifier">animated_model</span><span class="special">&gt;()</span>
    <span class="special">.</span><span class="identifier">add</span><span class="special">&lt;</span><span class="identifier">enemy_ai</span><span class="special">&gt;();</span>

<span class="identifier">enemy</span><span class="special">.</span><span class="identifier">get</span><span class="special">&lt;</span><span class="identifier">has_id</span><span class="special">&gt;()-&gt;</span><span class="identifier">set_id</span><span class="special">(</span><span class="number">1</span><span class="special">);</span>
<span class="identifier">set_mesh</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">,</span> <span class="string">"spider.mesh"</span><span class="special">);</span>

<span class="identifier">trace</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">,</span> <span class="identifier">cout</span><span class="special">);</span> <span class="comment">// trace enemy data</span>

<span class="identifier">object</span> <span class="identifier">ally</span><span class="special">;</span>

<span class="identifier">mutate</span><span class="special">(</span><span class="identifier">ally</span><span class="special">)</span>
    <span class="special">.</span><span class="identifier">add</span><span class="special">&lt;</span><span class="identifier">has_id</span><span class="special">&gt;()</span>
    <span class="special">.</span><span class="identifier">add</span><span class="special">&lt;</span><span class="identifier">animated_model</span><span class="special">&gt;()</span>
    <span class="special">.</span><span class="identifier">add</span><span class="special">&lt;</span><span class="identifier">ally_ai</span><span class="special">&gt;();</span>

<span class="identifier">ally</span><span class="special">.</span><span class="identifier">get</span><span class="special">&lt;</span><span class="identifier">has_id</span><span class="special">&gt;()-&gt;</span><span class="identifier">set_id</span><span class="special">(</span><span class="number">5</span><span class="special">);</span>
<span class="identifier">set_mesh</span><span class="special">(</span><span class="identifier">ally</span><span class="special">,</span> <span class="string">"dog.mesh"</span><span class="special">);</span>

<span class="identifier">trace</span><span class="special">(</span><span class="identifier">ally</span><span class="special">,</span> <span class="identifier">cout</span><span class="special">);</span> <span class="comment">// trace ally data</span>
</pre>
<p>
      </p>
<p>
        Both calls to <code class="computeroutput"><span class="identifier">trace</span></code> from
        above will display info about the newly constructed objects in the console.
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">think</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">);</span> <span class="comment">// doing enemy stuff</span>
<span class="identifier">think</span><span class="special">(</span><span class="identifier">ally</span><span class="special">);</span> <span class="comment">// doing friendly stuff</span>

<span class="identifier">render</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">);</span> <span class="comment">// drawing a hostile enemy</span>
<span class="identifier">render</span><span class="special">(</span><span class="identifier">ally</span><span class="special">);</span> <span class="comment">// drawing a friendly ally</span>
</pre>
<p>
      </p>
<p>
        Now lets try stunning our enemy. We'll just add the <code class="computeroutput"><span class="identifier">stunned_ai</span></code>
        mixin and, because of its special <code class="computeroutput"><span class="identifier">think</span></code>
        priority, the calls to <code class="computeroutput"><span class="identifier">think</span></code>
        from then on will be handled by it.
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">mutate</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">).</span><span class="identifier">add</span><span class="special">&lt;</span><span class="identifier">stunned_ai</span><span class="special">&gt;();</span>
<span class="identifier">think</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">);</span> <span class="comment">// don't do hostile stuff, because you're stunned</span>
<span class="identifier">render</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">);</span> <span class="comment">// drawing a stunned enemy</span>
</pre>
<p>
      </p>
<p>
        Now let's remove the stun effect from our enemy, by simply removing the
        <code class="computeroutput"><span class="identifier">stunned_ai</span></code> mixin from the
        object. The handling of <code class="computeroutput"><span class="identifier">think</span></code>
        by <code class="computeroutput"><span class="identifier">enemy_ai</span></code> will resume as
        before.
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">mutate</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">).</span><span class="identifier">remove</span><span class="special">&lt;</span><span class="identifier">stunned_ai</span><span class="special">&gt;();</span>
<span class="identifier">think</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">);</span> <span class="comment">// again do hostile stuff</span>
<span class="identifier">render</span><span class="special">(</span><span class="identifier">enemy</span><span class="special">);</span> <span class="comment">// drawing a hostile enemy</span>
</pre>
<p>
      </p>
<p>
        And that concludes our tutorial on messages.
      </p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title">
<a name="boost_mixin.tutorials.combinators"></a><a class="link" href="tutorials.html#boost_mixin.tutorials.combinators" title="Multicast combinators">Multicast combinators</a>
</h3></div></div></div></div>
<div class="section"><div class="titlepage"><div><div><h3 class="title">
<a name="boost_mixin.tutorials.mutation"></a><a class="link" href="tutorials.html#boost_mixin.tutorials.mutation" title="Object mutation">Object mutation</a>
</h3></div></div></div></div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_mixin.tutorials.tips_tricks"></a><a class="link" href="tutorials.html#boost_mixin.tutorials.tips_tricks" title="Tips and tricks">Tips and tricks</a>
</h3></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            When adding the same set of messages to multiple mixins, create a define
            of them all. Like: <code class="computeroutput"><span class="preprocessor">#define</span>
            <span class="identifier">transform_messages</span> <span class="identifier">set_position_msg</span>
            <span class="special">&amp;</span> <span class="identifier">set_orientation_msg</span></code>.
            Then use it like this <code class="computeroutput"><span class="identifier">BOOST_DEFINE_MIXIN</span><span class="special">(</span><span class="identifier">x</span><span class="special">,</span> <span class="identifier">some_messages</span>
            <span class="special">&amp;</span> <span class="identifier">transform_messages</span><span class="special">);</span></code>
          </li>
<li class="listitem">
            Instead of using the long message declaration macros, consider defining
            your own. Maybe something like <code class="computeroutput"><span class="preprocessor">#define</span>
            <span class="identifier">BM_C_MSG_1</span> <span class="identifier">BOOST_MIXIN_CONST_MESSAGE_1</span></code>
          </li>
<li class="listitem">
            Prefer using <code class="computeroutput"><span class="identifier">object_type_template</span></code>-s
            instead of mutating each new object.
          </li>
<li class="listitem">
            Prefer using <code class="computeroutput"><span class="identifier">same_type_mutator</span></code>
            when mutating multiple objects of the same type.
          </li>
</ul></div>
<div class="section"><div class="titlepage"><div><div><h4 class="title">
<a name="boost_mixin.tutorials.tips_tricks.common_mixin_parent"></a><a class="link" href="tutorials.html#boost_mixin.tutorials.tips_tricks.common_mixin_parent" title="Mixins with a common parent">Mixins
        with a common parent</a>
</h4></div></div></div></div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title">
<a name="boost_mixin.tutorials.common_problems"></a><a class="link" href="tutorials.html#boost_mixin.tutorials.common_problems" title="Common problems and solutions">Common problems
      and solutions</a>
</h3></div></div></div></div>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a id="ftn.boost_mixin.tutorials.messages.f0" href="#boost_mixin.tutorials.messages.f0" class="para">1</a>] </sup>
          Although set_mesh is a message that can be handled by a single class in
          our example, in an actual product there would be other types of "model"
          mixins, which would make it polymorphic. That's why we're making it a message
          instead of a method to be called by <code class="computeroutput"><span class="identifier">object</span><span class="special">.</span><span class="identifier">get</span><span class="special">&lt;</span><span class="identifier">animated_model</span><span class="special">&gt;()-&gt;</span><span class="identifier">set_mesh</span><span class="special">(</span><span class="identifier">somemesh</span><span class="special">)</span></code>
        </p></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2013 Borislav Stanimirov, Zahary Karadjov<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>).
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="glossary.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="examples.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
